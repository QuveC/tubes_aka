<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Tubes AKA - Metode Horner (Ultra-Stable Version)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #3498db; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 20px; background-color: var(--bg); }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 3px solid var(--primary); margin-bottom: 25px; padding-bottom: 10px; }
        .controls { display: flex; gap: 15px; justify-content: center; align-items: center; margin-bottom: 25px; background: #f1f5f9; padding: 20px; border-radius: 10px; }
        input { padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; width: 150px; font-size: 16px; }
        button { padding: 10px 25px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { background: #2980b9; }
        button:disabled { background: #94a3b8; cursor: not-allowed; }
        .status-container { text-align: center; margin-bottom: 10px; }
        .progress-text { color: var(--primary); font-weight: bold; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin-top: 25px; }
        th, td { border: 1px solid #e2e8f0; padding: 12px; text-align: center; }
        th { background: #f8fafc; color: #475569; }
        .footer { font-size: 0.85em; color: #64748b; margin-top: 30px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>Analisis Kompleksitas Algoritma</h2>
        <p>Evaluasi Polinomial (Metode Horner) | Iteratif vs Rekursif [cite: 17]</p>
    </div>

    <div class="controls">
        <label>Input Maksimal (n):</label>
        <input type="number" id="inputN" value="3000" min="100" max="10000">
        <button id="runBtn" onclick="runExperiment()">Mulai Analisis</button>
    </div>

    <div class="status-container">
        <div id="statusText" class="progress-text">Siap untuk pengujian.</div>
    </div>
    
    <canvas id="hornerChart" height="120"></canvas>

    <table>
        <thead>
            <tr>
                <th>Derajat (n)</th>
                <th>Iteratif (ms)</th>
                <th>Rekursif (ms)</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr><td colspan="3">Data akan muncul di sini.</td></tr>
        </tbody>
    </table>

    <div class="footer">
        Farel Gian Pratama (103012400195) | Akmal Luigi (103012400) | Ahmad Aqiela (103012400077)
    </div>
</div>

<script>
    let myChart;

    function hornerIterative(poly, x) {
        let result = poly[0];
        for (let i = 1; i < poly.length; i++) {
            result = result * x + poly[i];
        }
        return result;
    }

    function hornerRecursive(poly, x, i) {
        if (i === poly.length - 1) return poly[i];
        return poly[i] + x * hornerRecursive(poly, x, i + 1);
    }

    function getStableAverage(data) {
        data.sort((a, b) => a - b);
        const start = Math.floor(data.length * 0.25);
        const end = Math.floor(data.length * 0.75);
        const trimmed = data.slice(start, end);
        return trimmed.reduce((a, b) => a + b, 0) / trimmed.length;
    }

    async function runExperiment() {
        const input = document.getElementById('inputN');
        const btn = document.getElementById('runBtn');
        const status = document.getElementById('statusText');
        
        const maxN = parseInt(input.value);
        input.value = ""; 
        btn.disabled = true;

        const sizes = [1, 100, 500, 1000, 1500, 2000, 2500, maxN].sort((a,b) => a-b);
        const xVal = 2.5;
        const trials = 2000; 

        const dataI = [];
        const dataR = [];
        const tableRows = [];

        status.innerText = "Melakukan pemanasan sistem...";
        const warmPoly = new Float64Array(100).fill(0.5);
        for(let i=0; i<5000; i++) { hornerIterative(warmPoly, xVal); hornerRecursive(warmPoly, xVal, 0); }

        for (let n of sizes) {
            status.innerText = `Menganalisis n = ${n}...`;
            await new Promise(r => setTimeout(r, 10));

            const poly = new Float64Array(n + 1).fill(Math.random());
            
            // Pengukuran Iteratif
            let resultsI = [];
            for(let t=0; t<trials; t++) {
                let s = performance.now();
                hornerIterative(poly, xVal);
                resultsI.push(performance.now() - s);
            }
            const avgI = getStableAverage(resultsI);
            dataI.push(avgI);

            // Pengukuran Rekursif
            let avgR = null;
            try {
                if (n > 7000) throw new Error("SO");
                let resultsR = [];
                for(let t=0; t<trials; t++) {
                    let s = performance.now();
                    hornerRecursive(poly, xVal, 0);
                    resultsR.push(performance.now() - s);
                }
                avgR = getStableAverage(resultsR);
            } catch (e) { avgR = null; }
            dataR.push(avgR);

            tableRows.push(`<tr><td>${n}</td><td>${avgI.toFixed(8)}</td><td>${avgR !== null ? avgR.toFixed(8) : "Stack Overflow"}</td></tr>`);
        }

        document.getElementById('tableBody').innerHTML = tableRows.join("");
        renderChart(sizes, dataI, dataR);
        status.innerText = "Analisis Selesai. Grafik Stabil Dihasilkan.";
        btn.disabled = false;
    }

    function renderChart(labels, dataI, dataR) {
        const ctx = document.getElementById('hornerChart').getContext('2d');
        if (myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    { label: 'Iteratif', data: dataI, borderColor: '#3498db', borderWidth: 3, pointRadius: 4, fill: false },
                    { label: 'Rekursif', data: dataR, borderColor: '#e74c3c', borderWidth: 3, pointRadius: 4, fill: false }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    x: { title: { display: true, text: 'Ukuran Masukan (n)' } },
                    y: { title: { display: true, text: 'Waktu Rata-rata (ms)' }, beginAtZero: true }
                }
            }
        });
    }
</script>
</body>
</html> 